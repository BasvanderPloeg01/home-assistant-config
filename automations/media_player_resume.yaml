#
# Media player plays content.
#
- id: media_player_resume
  alias: Media player RESUME
  trigger:
    - platform: state
      entity_id: media_player.kodi
      to: 'playing'

  condition:
    # Sun has set.
    - condition: state
      entity_id: sun.sun
      state: 'below_horizon'

    # Not during the nap mode.
    - condition: state
      entity_id: input_boolean.nap_mode
      state: 'off'

  action:
    # Activate scene mode.
    - service: input_boolean.turn_on
      entity_id: input_boolean.scene_mode

    # Dim the spot lights.
    - service: light.lifx_set_state
      data:
        entity_id:
          - light.shower
          - light.spotlight
      data_template:
        brightness: 100
        transition: 2

    # If ceiling wash lights are on, set them to their dedicated Movie scene.
    - condition: state
      entity_id: group.ceiling
      state: 'on'
    - service: variable.set_variable
      data:
        variable: ceiling_effect
        value: "Movie"

    # If the Aurora is active, set it to its dedicated Movie scene.
    - condition: state
      entity_id: light.aurora
      state: 'on'
    - service: variable.set_variable
      data:
        variable: aurora_effect
        value: "Flames"
    - service: variable.set_variable
      data:
        variable: aurora_brightness
        value: "21"
