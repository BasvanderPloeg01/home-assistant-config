#
# Check if humidity is too high
#
# Only verify if doors and windows are closed.
#
# Todo: check more regularly
#
# @subscribe input_boolean.doors_open
# @subscribe input_boolean.windows_open
#
- id: check_humidity_high
  alias: Check humidity HIGH
  trigger:
    # At noon.
    - platform: time
      hours: 12
      minutes: 00
      seconds: 00

  condition:
    # Humidity is too high.
    - condition: numeric_state
      entity_id: sensor.average_humidity
      above: 50

    # Doors are closed.
    - condition: state
      entity_id: input_boolean.doors_open
      state: 'off'

    # Windows are closed.
    - condition: state
      entity_id: input_boolean.windows_open
      state: 'off'

  action:
    # Warn someone to take action.
    - service: persistent_notification.create
      data:
        notification_id: humidity
        title: "Humidity is too high: {{ states('sensor.average_humidity') }}%"
        message: "Check the dehumidifier."
